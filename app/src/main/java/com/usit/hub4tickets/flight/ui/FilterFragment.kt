package com.usit.hub4tickets.flight.uiimport android.os.Bundleimport android.util.Logimport android.view.LayoutInflaterimport android.view.Viewimport android.view.ViewGroupimport com.usit.hub4tickets.flight.Utilsimport com.usit.hub4tickets.flight.model.FilterModelimport com.usit.hub4tickets.utils.Constantimport kotlinx.android.synthetic.main.common_toolbar.*import kotlinx.android.synthetic.main.fragment_filter.*/** * Created by Bhagyashri Burade * Date: 14/01/2019 * Email: bhagyashri.burade@usit.net.in */class FilterFragment : RootDialogFragment() {    private var maxStopovers: String = "0"    private var minValuePrice: String = "1000"    private var maxValuePrice: String = "10000"    private var minValueDuration: String = "1"    private var maxValueDuration: String = "10"    private var minValueOutbound: String = "1"    private var maxValueOutbound: String = "10"    var filterData: FilterModel.Filter? = null    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        arguments?.let {            filterData = it?.get(Constant.Path.FILTER_DATA) as FilterModel.Filter?        }    }    override fun onCreateView(        inflater: LayoutInflater, container: ViewGroup?,        savedInstanceState: Bundle?    ): View? {        return inflater.inflate(com.usit.hub4tickets.R.layout.fragment_filter, container, false)    }    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {        super.onViewCreated(view, savedInstanceState)        setToolBar()        if (filterData != null) {            init()        } else {            setOtherListeners()        }    }    private fun init() {        textMin_price.text = filterData?.price_from        range_seekbar_price.setMinValue(10f).setMaxValue(filterData?.price_to?.toFloat()!!)            .setMinStartValue(filterData?.price_from?.toFloat()!!).setMaxStartValue(filterData?.price_to?.toFloat()!!).apply()        range_seekbar.setOnRangeSeekbarChangeListener { minValue, maxValue ->            textMin.text = minValue.toString()            textMax.text = maxValue.toString()        }    }    private fun setOtherListeners() {        setRangeSeekbarForPrice()        setRangeSeekbarForDuration()        setRangeSeekbarForaOutstanding()        button_dialog_cancel.setOnClickListener { onBackPressed() }        switchButton_direct?.setOnCheckedChangeListener { _, isChecked ->            if (isChecked)                maxStopovers = "0"        }        switchButton_1stop?.setOnCheckedChangeListener { _, isChecked ->            if (isChecked)                maxStopovers = "1"        }        switchButton_2stops?.setOnCheckedChangeListener { _, isChecked ->            if (isChecked)                maxStopovers = "2"        }        button_dialog_apply.setOnClickListener {            val filterModel = FilterModel.Filter(                minValuePrice, maxValuePrice, minValueDuration, maxValueDuration,                minValueOutbound, maxValueOutbound, maxStopovers            )            if (Utils.notifier != null) {                Utils.notifier!!.notify(filterModel)            }            onBackPressed()        }    }    private fun setToolBar() {        activity?.titleToolBar?.text = resources.getString(com.usit.hub4tickets.R.string.filter)        activity?.mainToolbar?.setNavigationOnClickListener { onBackPressed() }    }    private fun setRangeSeekbarForDuration() {        range_seekbar.setOnRangeSeekbarFinalValueListener { minValue, maxValue ->            Log.d(                "CRS=>",                minValue.toString() + " : " + maxValue.toString()            )            minValueDuration = minValue.toString()            maxValueDuration = maxValue.toString()        }    }    private fun setRangeSeekbarForPrice() {        /*if (filterData != null) {            textMin_price.text = filterData?.price_from             Handler().postDelayed({            range_seekbar_price.setMinValue(filterData?.price_from?.toFloat()!!).setMaxValue(filterData?.price_to?.toFloat()!!)                .setMinStartValue(filterData?.price_from?.toFloat()!!).setMaxStartValue(filterData?.price_to?.toFloat()!!).apply()        }, 1000)            range_seekbar_price.setMinValue(filterData?.price_from?.toFloat()!!).apply()        }*/        range_seekbar_price.setOnRangeSeekbarChangeListener { minValue, maxValue ->            textMin_price.text = minValue.toString()            textMax_price.text = maxValue.toString()        }        // set final value listener        range_seekbar_price.setOnRangeSeekbarFinalValueListener { minValue, maxValue ->            Log.d(                "CRS=>",                minValue.toString() + " : " + maxValue.toString()            )            minValuePrice = minValue.toString()            maxValuePrice = maxValue.toString()        }    }    private fun setRangeSeekbarForaOutstanding() {        range_seekbar_outbound_trip.setOnRangeSeekbarChangeListener { minValue, maxValue ->            textMin_outbound.text = minValue.toString()            textMax_outbound.text = maxValue.toString()        }        range_seekbar_outbound_trip.setOnRangeSeekbarFinalValueListener { minValue, maxValue ->            Log.d(                "CRS=>",                minValue.toString() + " : " + maxValue.toString()            )            minValueOutbound = minValue.toString()            maxValueOutbound = maxValue.toString()        }    }    override fun onBackPressed(): Boolean {        return fragmentManager?.popBackStackImmediate()!!    }}